import{b as k,u as C,r as a,s as A,j as e,L as v,D}from"./index-B2v4ih3O.js";import{a as c}from"./axiosInstance-Dc8xx1j4.js";import{S as n}from"./sweetalert2.esm.all-acGi8jXx.js";const L=()=>{const f=k(),{currentUser:S}=C(s=>s.user),[h,x]=a.useState([]),[u,p]=a.useState([]),[l,N]=a.useState(10),[r,o]=a.useState(1),[m,d]=a.useState(!0);a.useEffect(()=>{f(A("Events")),d(!0),b()},[l,r]);const b=async()=>{try{const s=await c.get(`/events/published?limit=${l}&page=${r}`);x(s.data.results||[]);const t=await c.get(`/events?limit=${l}&page=${r}&event_status=unpublished`);p(t.data.results||[])}catch(s){console.error("Error fetching events:",s),n.fire("Error","Failed to fetch events.","error")}finally{d(!1)}},w=async s=>{try{await c.delete(`/events/${s}`),b(),n.fire("Deleted!","Event has been deleted.","success")}catch(t){console.error("Error deleting event:",t),n.fire("Error","Failed to delete event.","error")}},E=async s=>{try{await c.patch(`/events/${s}/status`,{event_status:"published"}),p(i=>i.filter(j=>j.id!==s));const{data:t}=await c.get(`/events/${s}`);x(i=>i.some(y=>y.id===t.id)?i:[t,...i]),n.fire("Approved!","Event has been approved.","success")}catch(t){console.error("Error approving event:",t),n.fire("Error","Failed to approve event.","error")}},g=async(s,t)=>{(await n.fire({icon:"warning",title:"Are you sure?",text:"You won't be able to revert this!",showCancelButton:!0,confirmButtonText:"Delete"})).isConfirmed&&await w(t)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"mb-5",children:e.jsxs("ol",{className:"flex text-primary font-semibold dark:text-white-dark",children:[e.jsx("li",{className:"bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]",children:e.jsx(v,{to:"/",className:"p-1.5",children:"Home"})}),e.jsx("li",{className:"bg-primary text-white-light",children:e.jsx("button",{children:"Events"})})]})}),m?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-32 w-32 border-b-2 border-primary"})}):e.jsxs(e.Fragment,{children:[u.length>0&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Pending Approval"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:u.map(s=>e.jsxs("div",{className:"relative bg-white shadow-md rounded p-5 dark:bg-[#191e3a]",children:[e.jsx("h5",{className:"text-lg font-semibold mb-2 dark:text-white-light",children:s.title}),e.jsx("p",{className:"mb-2 dark:text-[#9CA3AF]",children:s.description||"No description"}),e.jsxs("div",{className:"flex space-x-2 rtl:space-x-reverse mt-2",children:[e.jsx("button",{onClick:()=>E(s.id),className:"btn btn-success btn-sm",children:"Approve"}),e.jsx("button",{onClick:()=>g("delete",s.id),className:"btn btn-danger btn-sm",children:"Delete"})]})]},s.id))})]}),e.jsx("h3",{className:"text-lg font-semibold mb-3",children:"Published Events"}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-5",children:h.map(s=>e.jsxs("div",{className:"relative bg-white shadow-md rounded p-5 dark:bg-[#191e3a]",children:[e.jsx("div",{className:"dropdown absolute top-2 right-2 z-10",children:e.jsx(D,{placement:"bottom-end",btnClassName:"btn btn-secondary dropdown-toggle w-auto h-auto px-2 py-1 text-sm flex items-center",button:e.jsx("span",{children:"Edit"}),children:e.jsxs("ul",{className:"!min-w-[120px]",children:[e.jsx("li",{children:e.jsx(v,{to:`/edit/event/${s.id}`,children:"Edit"})}),e.jsx("li",{children:e.jsx("button",{onClick:()=>g("delete",s.id),children:"Delete"})})]})})}),e.jsx("h5",{className:"text-lg font-semibold mb-2 dark:text-white-light",children:s.title}),e.jsx("p",{className:"mb-2 dark:text-[#9CA3AF]",children:s.description||"No description"})]},s.id))}),e.jsxs("div",{className:"flex justify-center mt-10",children:[e.jsx("button",{disabled:r===1||m,onClick:()=>{o(r-1),d(!0)},className:"btn btn-sm mr-2",children:"Prev"}),e.jsxs("span",{className:"btn btn-sm px-4 py-1",children:["Page ",r]}),e.jsx("button",{disabled:h.length<l||m,onClick:()=>{o(r+1),d(!0)},className:"btn btn-sm ml-2",children:"Next"})]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-4",children:[e.jsx("span",{children:"Items per page:"}),e.jsxs("select",{className:"border rounded px-2 py-1",value:l,onChange:s=>{N(Number(s.target.value)),o(1),d(!0)},children:[e.jsx("option",{value:5,children:"5"}),e.jsx("option",{value:10,children:"10"}),e.jsx("option",{value:20,children:"20"})]})]})]})]})};export{L as default};
