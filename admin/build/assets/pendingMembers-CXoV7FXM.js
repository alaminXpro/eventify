import{j as e,b as D,u as F,r as o,o as U,s as q,L as k}from"./index-B2v4ih3O.js";import{M as H,q as O}from"./styles-H4kfqB2f.js";import{s as S,I as E,a as G,w as W}from"./IconEye-BuFgXFn0.js";import{a as p}from"./axiosInstance-Dc8xx1j4.js";import{S as a}from"./sweetalert2.esm.all-acGi8jXx.js";const Z=({className:i,fill:u=!1,duotone:n=!0})=>e.jsxs("svg",{width:"20",height:"20",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:"1.5",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",className:i,children:[e.jsx("line",{x1:"12",y1:"5",x2:"12",y2:"19"}),e.jsx("line",{x1:"5",y1:"12",x2:"19",y2:"12"})]}),X=()=>{const i=D(),{currentUser:u}=F(r=>r.user),[n,h]=o.useState([]),[x,$]=o.useState(!0),[j,I]=o.useState(null),{clubId:d}=U();o.useEffect(()=>{i(q("Pending Members")),(async()=>{try{const t=await p.post(`/clubs/${d}/pendings`,{moderatorId:u.id});h(t.data)}catch{I("Failed to load pending members")}finally{$(!1)}})()},[i,d,u.id]);const w=async()=>{try{if(l.length===0)return a.fire("Error","Please select members to remove.","error");const r=await p.delete(`/clubs/${d}/pendings`,{data:{memberIds:l.map(t=>t.id)}});h(n.filter(t=>!l.some(s=>s.id===t.id))),v([]),a.fire("Success","Selected members have been removed from the pending list.","success")}catch{a.fire("Error","Failed to remove selected members.","error")}},L=async()=>{try{if(l.length===0)return a.fire("Error","Please select members to approve.","error");const r=await p.post(`/clubs/${d}/approve`,{memberIds:l.map(t=>t.id)});h(n.filter(t=>!l.some(s=>s.id===t.id))),v([]),a.fire("Success","Selected members have been approved.","success")}catch{a.fire("Error","Failed to approve selected members.","error")}},[g,y]=o.useState(1),N=[10,20,30,50,100],[b,A]=o.useState(N[0]),[c,P]=o.useState([]),[R,C]=o.useState([]),[l,v]=o.useState([]),[m,M]=o.useState(""),[f,z]=o.useState({columnAccessor:"name",direction:"asc"});if(o.useEffect(()=>{x||P(S(n,"name"))},[n,x]),o.useEffect(()=>{const r=(g-1)*b,t=r+b;C([...c.slice(r,t)])},[g,b,c]),o.useEffect(()=>{const r=n.filter(t=>t.name.toLowerCase().includes(m.toLowerCase())||t.email.toLowerCase().includes(m.toLowerCase()));P(S(r,"name"))},[m,n]),o.useEffect(()=>{const r=S(c,f.columnAccessor);C(f.direction==="desc"?r.reverse():r),y(1)},[f,c]),x)return e.jsx("div",{children:"Loading..."});if(j)return e.jsx("div",{children:j});const T=W(a),B=async r=>{try{const s=(await p.get(`/sslcommerz/transaction/${r}`)).data;T.fire({title:"Transaction Details",html:`
          <div class="text-left">
            <p><strong>Transaction ID:</strong> ${s.tranId}</p>
            <p><strong>Amount:</strong> ${s.amount} ${s.currency}</p>
            <p><strong>Payment Status:</strong> ${s.paymentStatus}</p>
            <p><strong>User Name:</strong> ${s.userName}</p>
            <p><strong>User Email:</strong> ${s.userEmail}</p>
            <p><strong>User Phone:</strong> ${s.userPhone}</p>
            <p><strong>Created At:</strong> ${new Date(s.createdAt).toLocaleString()}</p>
            <p><strong>Updated At:</strong> ${new Date(s.updatedAt).toLocaleString()}</p>
          </div>
        `,showCloseButton:!0,showCancelButton:!1,focusConfirm:!1,confirmButtonText:"Close",customClass:{popup:"sweet-alerts"}})}catch(t){console.error("Error fetching transaction:",t),a.fire("Error","Failed to fetch transaction.","error")}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("ol",{className:"flex text-primary font-semibold dark:text-white-dark",children:[e.jsx("li",{className:"bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]",children:e.jsx(k,{to:"/",className:"p-1.5 ltr:pl-3 rtl:pr-3 ltr:pr-2 rtl:pl-2 relative  h-full flex items-center before:absolute ltr:before:-right-[15px] rtl:before:-left-[15px] rtl:before:rotate-180 before:inset-y-0 before:m-auto before:w-0 before:h-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-t-transparent before:border-b-transparent before:border-l-[#ebedf2] before:z-[1] dark:before:border-l-[#1b2e4b] hover:text-primary/70 dark:hover:text-white-dark/70",children:"Home"})}),e.jsx("li",{className:"bg-[#ebedf2] dark:bg-[#1b2e4b]",children:e.jsx(k,{to:"/clubs",className:"bg-primary text-white-light p-1.5 ltr:pl-6 rtl:pr-6 ltr:pr-2 rtl:pl-2 relative  h-full flex items-center before:absolute ltr:before:-right-[15px] rtl:before:-left-[15px] rtl:before:rotate-180 before:inset-y-0 before:m-auto before:w-0 before:h-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-t-transparent before:border-b-transparent before:border-l-primary before:z-[1]",children:"Clubs"})}),e.jsx("li",{className:"bg-[#ebedf2] dark:bg-[#1b2e4b]",children:e.jsx("button",{className:"p-1.5 px-3 ltr:pl-6 rtl:pr-6 relative  h-full flex items-center before:absolute ltr:before:-right-[15px] rtl:before:-left-[15px] rtl:before:rotate-180 before:inset-y-0 before:m-auto before:w-0 before:h-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-t-transparent before:border-b-transparent before:border-l-[#ebedf2] before:z-[1] dark:before:border-l-[#1b2e4b] hover:text-primary/70 dark:hover:text-white-dark/70",children:"Pending Members"})})]})}),e.jsx(H,{children:e.jsx("div",{className:"pt-5",children:e.jsx("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:e.jsxs("div",{className:"invoice-table",children:[e.jsxs("div",{className:"mb-4.5 px-5 flex md:items-center md:flex-row flex-col gap-5",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",className:"btn btn-danger gap-2",onClick:w,children:[e.jsx(E,{}),"Remove Selected"]}),e.jsxs("button",{className:"btn btn-primary gap-2",onClick:L,children:[e.jsx(Z,{}),"Approve Selected"]})]}),e.jsx("div",{className:"ltr:ml-auto rtl:mr-auto",children:e.jsx("input",{type:"text",className:"form-input w-auto",placeholder:"Search...",value:m,onChange:r=>M(r.target.value)})})]}),e.jsx("div",{className:"datatables pagination-padding",children:e.jsx(O,{className:"whitespace-nowrap table-hover invoice-table",records:R,columns:[{accessor:"name",sortable:!0,render:({name:r})=>e.jsx("div",{className:"font-semibold",children:r})},{accessor:"email",sortable:!0},{accessor:"transaction",sortable:!0,render:({id:r})=>e.jsx("button",{onClick:()=>B(r),type:"button",className:"flex hover:text-primary",children:e.jsx(G,{})})},{accessor:"status",sortable:!0,render:()=>e.jsx("span",{className:"badge badge-outline-danger",children:"Pending"})},{accessor:"action",title:"Actions",sortable:!1,textAlignment:"center",render:({id:r})=>e.jsx("div",{className:"flex gap-4 items-center w-max mx-auto",children:e.jsx("button",{type:"button",className:"flex hover:text-danger",onClick:()=>w(),children:e.jsx(E,{})})})}],highlightOnHover:!0,totalRecords:c.length,recordsPerPage:b,page:g,onPageChange:r=>y(r),recordsPerPageOptions:N,onRecordsPerPageChange:A,sortStatus:f,onSortStatusChange:z,selectedRecords:l,onSelectedRecordsChange:v,paginationText:({from:r,to:t,totalRecords:s})=>`Showing ${r} to ${t} of ${s} entries`})})]})})})})]})};export{X as default};
