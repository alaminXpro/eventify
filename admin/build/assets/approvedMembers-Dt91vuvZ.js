import{b as T,u as U,r as s,o as B,s as F,j as e,L as E}from"./index-B2v4ih3O.js";import{M as q,q as H}from"./styles-H4kfqB2f.js";import{s as u,I as P,a as O,w as G}from"./IconEye-BuFgXFn0.js";import{a as h}from"./axiosInstance-Dc8xx1j4.js";import{S as l}from"./sweetalert2.esm.all-acGi8jXx.js";const V=()=>{const x=T(),{currentUser:k}=U(r=>r.user),[a,g]=s.useState([]),[f,A]=s.useState(!0),[v,$]=s.useState(null),{clubId:p}=B();s.useEffect(()=>{x(F("Approved Members")),(async()=>{try{const t=await h.post(`/clubs/${p}/members`,{moderatorId:k.id});g(t.data)}catch{$("Failed to load approved members")}finally{A(!1)}})()},[x,p]);const S=async()=>{try{if(i.length===0)return l.fire("Error","Please select members to delete.","error");const r=await h.post(`/clubs/${p}/delete`,{memberIds:i.map(t=>t.id)});g(a.filter(t=>!i.some(o=>o.id===t.id))),C([]),l.fire("Success","Selected members have been deleted.","success")}catch{l.fire("Error","Failed to delete selected members.","error")}},[m,j]=s.useState(1),w=[10,20,30,50,100],[c,I]=s.useState(w[0]),[n,y]=s.useState([]),[L,N]=s.useState([]),[i,C]=s.useState([]),[d,R]=s.useState(""),[b,M]=s.useState({columnAccessor:"name",direction:"asc"});if(s.useEffect(()=>{f||y(u(a,"name"))},[a,f]),s.useEffect(()=>{const r=(m-1)*c,t=r+c;N([...n.slice(r,t)])},[m,c,n]),s.useEffect(()=>{const r=a.filter(t=>t.name.toLowerCase().includes(d.toLowerCase())||t.email.toLowerCase().includes(d.toLowerCase()));y(u(r,"name"))},[d,a]),s.useEffect(()=>{const r=u(n,b.columnAccessor);N(b.direction==="desc"?r.reverse():r),j(1)},[b,n]),f)return e.jsx("div",{children:"Loading..."});if(v)return e.jsx("div",{children:v});const z=G(l),D=async r=>{try{const o=(await h.get(`/sslcommerz/transaction/${r}`)).data;console.log(o),z.fire({title:"Transaction Details",html:`
          <div class="text-left">
            <p><strong>Transaction ID:</strong> ${o.tranId}</p>
            <p><strong>Amount:</strong> ${o.amount} ${o.currency}</p>
            <p><strong>Payment Status:</strong> ${o.paymentStatus}</p>
            <p><strong>User Name:</strong> ${o.userName}</p>
            <p><strong>User Email:</strong> ${o.userEmail}</p>
            <p><strong>User Phone:</strong> ${o.userPhone}</p>
            <p><strong>Created At:</strong> ${new Date(o.createdAt).toLocaleString()}</p>
            <p><strong>Updated At:</strong> ${new Date(o.updatedAt).toLocaleString()}</p>
          </div>
        `,showCloseButton:!0,showCancelButton:!1,focusConfirm:!1,confirmButtonText:"Close",customClass:{popup:"sweet-alerts"}})}catch(t){console.error("Error fetching transaction:",t),l.fire("Error","Failed to fetch transaction.","error")}};return e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"space-y-6",children:e.jsxs("ol",{className:"flex text-primary font-semibold dark:text-white-dark",children:[e.jsx("li",{className:"bg-[#ebedf2] ltr:rounded-l-md rtl:rounded-r-md dark:bg-[#1b2e4b]",children:e.jsx(E,{to:"/",className:"p-1.5 ltr:pl-3 rtl:pr-3 ltr:pr-2 rtl:pl-2 relative  h-full flex items-center before:absolute ltr:before:-right-[15px] rtl:before:-left-[15px] rtl:before:rotate-180 before:inset-y-0 before:m-auto before:w-0 before:h-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-t-transparent before:border-b-transparent before:border-l-[#ebedf2] before:z-[1] dark:before:border-l-[#1b2e4b] hover:text-primary/70 dark:hover:text-white-dark/70",children:"Home"})}),e.jsx("li",{className:"bg-[#ebedf2] dark:bg-[#1b2e4b]",children:e.jsx(E,{to:"/clubs",className:"bg-primary text-white-light p-1.5 ltr:pl-6 rtl:pr-6 ltr:pr-2 rtl:pl-2 relative  h-full flex items-center before:absolute ltr:before:-right-[15px] rtl:before:-left-[15px] rtl:before:rotate-180 before:inset-y-0 before:m-auto before:w-0 before:h-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-t-transparent before:border-b-transparent before:border-l-primary before:z-[1]",children:"Clubs"})}),e.jsx("li",{className:"bg-[#ebedf2] dark:bg-[#1b2e4b]",children:e.jsx("button",{className:"p-1.5 px-3 ltr:pl-6 rtl:pr-6 relative  h-full flex items-center before:absolute ltr:before:-right-[15px] rtl:before:-left-[15px] rtl:before:rotate-180 before:inset-y-0 before:m-auto before:w-0 before:h-0 before:border-[16px] before:border-l-[15px] before:border-r-0 before:border-t-transparent before:border-b-transparent before:border-l-[#ebedf2] before:z-[1] dark:before:border-l-[#1b2e4b] hover:text-primary/70 dark:hover:text-white-dark/70",children:"Approved Members"})})]})}),e.jsx(q,{children:e.jsx("div",{className:"pt-5",children:e.jsx("div",{className:"panel px-0 border-white-light dark:border-[#1b2e4b]",children:e.jsxs("div",{className:"invoice-table",children:[e.jsxs("div",{className:"mb-4.5 px-5 flex md:items-center md:flex-row flex-col gap-5",children:[e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("button",{type:"button",className:"btn btn-danger gap-2",onClick:S,children:[e.jsx(P,{}),"Delete"]})}),e.jsx("div",{className:"ltr:ml-auto rtl:mr-auto",children:e.jsx("input",{type:"text",className:"form-input w-auto",placeholder:"Search...",value:d,onChange:r=>R(r.target.value)})})]}),e.jsx("div",{className:"datatables pagination-padding",children:e.jsx(H,{className:"whitespace-nowrap table-hover invoice-table",records:L,columns:[{accessor:"name",sortable:!0,render:({name:r})=>e.jsx("div",{className:"font-semibold",children:r})},{accessor:"email",sortable:!0},{accessor:"transaction",sortable:!0,render:({id:r})=>e.jsx("button",{onClick:()=>D(r),type:"button",className:"flex hover:text-primary",children:e.jsx(O,{})})},{accessor:"status",sortable:!0,render:()=>e.jsx("span",{className:"badge badge-outline-success",children:"Approved"})},{accessor:"action",title:"Actions",sortable:!1,textAlignment:"center",render:({id:r})=>e.jsx("div",{className:"flex gap-4 items-center w-max mx-auto",children:e.jsx("button",{type:"button",className:"flex hover:text-danger",onClick:()=>S(),children:e.jsx(P,{})})})}],highlightOnHover:!0,totalRecords:n.length,recordsPerPage:c,page:m,onPageChange:r=>j(r),recordsPerPageOptions:w,onRecordsPerPageChange:I,sortStatus:b,onSortStatusChange:M,selectedRecords:i,onSelectedRecordsChange:C,paginationText:({from:r,to:t,totalRecords:o})=>`Showing ${r} to ${t} of ${o} entries`})})]})})})})]})};export{V as default};
